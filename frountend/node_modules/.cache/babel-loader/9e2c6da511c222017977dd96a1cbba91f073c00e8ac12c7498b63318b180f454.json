{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { handleApiError, retryRequest } from '../utils/errorHandler';\n\n// Async thunks\nexport const fetchCategories = createAsyncThunk('categories/fetchCategories', async (params = {}, {\n  rejectWithValue,\n  getState\n}) => {\n  try {\n    // Check if we already have categories and this is not a forced refresh\n    const state = getState();\n    if (state.categories.categories.length > 0 && !params.forceRefresh) {\n      return state.categories;\n    }\n    const requestFn = async () => {\n      const response = await axios.get('/api/categories', {\n        params\n      });\n      return response.data.data;\n    };\n\n    // Use retry logic for rate limiting\n    const data = await retryRequest(requestFn, 3, 1000);\n    return data;\n  } catch (error) {\n    const errorInfo = handleApiError(error, error.response);\n    return rejectWithValue(errorInfo.message || 'Failed to fetch categories');\n  }\n});\nexport const fetchCategory = createAsyncThunk('categories/fetchCategory', async (categoryId, {\n  rejectWithValue\n}) => {\n  try {\n    const requestFn = async () => {\n      const response = await axios.get(`/api/categories/${categoryId}`);\n      return response.data.data;\n    };\n\n    // Use retry logic for rate limiting\n    const data = await retryRequest(requestFn, 3, 1000);\n    return data;\n  } catch (error) {\n    const errorInfo = handleApiError(error, error.response);\n    return rejectWithValue(errorInfo.message || 'Failed to fetch category');\n  }\n});\nconst initialState = {\n  categories: [],\n  currentCategory: null,\n  pagination: {\n    currentPage: 1,\n    totalPages: 1,\n    totalItems: 0,\n    itemsPerPage: 20,\n    hasNextPage: false,\n    hasPrevPage: false\n  },\n  loading: false,\n  error: null,\n  isRateLimited: false,\n  retryAfter: null,\n  lastFetched: null\n};\nconst categorySlice = createSlice({\n  name: 'categories',\n  initialState,\n  reducers: {\n    clearError: state => {\n      state.error = null;\n    },\n    clearCurrentCategory: state => {\n      state.currentCategory = null;\n    },\n    setRateLimited: (state, action) => {\n      state.isRateLimited = action.payload.isRateLimited;\n      state.retryAfter = action.payload.retryAfter;\n    },\n    clearRateLimit: state => {\n      state.isRateLimited = false;\n      state.retryAfter = null;\n    }\n  },\n  extraReducers: builder => {\n    builder\n    // Fetch categories\n    .addCase(fetchCategories.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(fetchCategories.fulfilled, (state, action) => {\n      state.loading = false;\n      state.categories = action.payload.categories;\n      state.pagination = action.payload.pagination;\n      state.error = null;\n      state.isRateLimited = false;\n      state.retryAfter = null;\n      state.lastFetched = Date.now();\n    }).addCase(fetchCategories.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload;\n\n      // Check if it's a rate limit error\n      if (action.payload && action.payload.includes('Too many requests')) {\n        state.isRateLimited = true;\n        state.retryAfter = 60; // Default retry after 60 seconds\n      }\n    })\n    // Fetch single category\n    .addCase(fetchCategory.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(fetchCategory.fulfilled, (state, action) => {\n      state.loading = false;\n      state.currentCategory = action.payload.category;\n      state.error = null;\n    }).addCase(fetchCategory.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload;\n    });\n  }\n});\nexport const {\n  clearError,\n  clearCurrentCategory,\n  setRateLimited,\n  clearRateLimit\n} = categorySlice.actions;\nexport default categorySlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","handleApiError","retryRequest","fetchCategories","params","rejectWithValue","getState","state","categories","length","forceRefresh","requestFn","response","get","data","error","errorInfo","message","fetchCategory","categoryId","initialState","currentCategory","pagination","currentPage","totalPages","totalItems","itemsPerPage","hasNextPage","hasPrevPage","loading","isRateLimited","retryAfter","lastFetched","categorySlice","name","reducers","clearError","clearCurrentCategory","setRateLimited","action","payload","clearRateLimit","extraReducers","builder","addCase","pending","fulfilled","Date","now","rejected","includes","category","actions","reducer"],"sources":["E:/blowpack/frountend/src/store/slices/categorySlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { handleApiError, retryRequest } from '../utils/errorHandler';\n\n// Async thunks\nexport const fetchCategories = createAsyncThunk(\n  'categories/fetchCategories',\n  async (params = {}, { rejectWithValue, getState }) => {\n    try {\n      // Check if we already have categories and this is not a forced refresh\n      const state = getState();\n      if (state.categories.categories.length > 0 && !params.forceRefresh) {\n        return state.categories;\n      }\n\n      const requestFn = async () => {\n        const response = await axios.get('/api/categories', { params });\n        return response.data.data;\n      };\n\n      // Use retry logic for rate limiting\n      const data = await retryRequest(requestFn, 3, 1000);\n      return data;\n    } catch (error) {\n      const errorInfo = handleApiError(error, error.response);\n      return rejectWithValue(errorInfo.message || 'Failed to fetch categories');\n    }\n  }\n);\n\nexport const fetchCategory = createAsyncThunk(\n  'categories/fetchCategory',\n  async (categoryId, { rejectWithValue }) => {\n    try {\n      const requestFn = async () => {\n        const response = await axios.get(`/api/categories/${categoryId}`);\n        return response.data.data;\n      };\n\n      // Use retry logic for rate limiting\n      const data = await retryRequest(requestFn, 3, 1000);\n      return data;\n    } catch (error) {\n      const errorInfo = handleApiError(error, error.response);\n      return rejectWithValue(errorInfo.message || 'Failed to fetch category');\n    }\n  }\n);\n\nconst initialState = {\n  categories: [],\n  currentCategory: null,\n  pagination: {\n    currentPage: 1,\n    totalPages: 1,\n    totalItems: 0,\n    itemsPerPage: 20,\n    hasNextPage: false,\n    hasPrevPage: false,\n  },\n  loading: false,\n  error: null,\n  isRateLimited: false,\n  retryAfter: null,\n  lastFetched: null,\n};\n\nconst categorySlice = createSlice({\n  name: 'categories',\n  initialState,\n  reducers: {\n    clearError: (state) => {\n      state.error = null;\n    },\n    clearCurrentCategory: (state) => {\n      state.currentCategory = null;\n    },\n    setRateLimited: (state, action) => {\n      state.isRateLimited = action.payload.isRateLimited;\n      state.retryAfter = action.payload.retryAfter;\n    },\n    clearRateLimit: (state) => {\n      state.isRateLimited = false;\n      state.retryAfter = null;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      // Fetch categories\n      .addCase(fetchCategories.pending, (state) => {\n        state.loading = true;\n        state.error = null;\n      })\n      .addCase(fetchCategories.fulfilled, (state, action) => {\n        state.loading = false;\n        state.categories = action.payload.categories;\n        state.pagination = action.payload.pagination;\n        state.error = null;\n        state.isRateLimited = false;\n        state.retryAfter = null;\n        state.lastFetched = Date.now();\n      })\n      .addCase(fetchCategories.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload;\n        \n        // Check if it's a rate limit error\n        if (action.payload && action.payload.includes('Too many requests')) {\n          state.isRateLimited = true;\n          state.retryAfter = 60; // Default retry after 60 seconds\n        }\n      })\n      // Fetch single category\n      .addCase(fetchCategory.pending, (state) => {\n        state.loading = true;\n        state.error = null;\n      })\n      .addCase(fetchCategory.fulfilled, (state, action) => {\n        state.loading = false;\n        state.currentCategory = action.payload.category;\n        state.error = null;\n      })\n      .addCase(fetchCategory.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload;\n      });\n  },\n});\n\nexport const { clearError, clearCurrentCategory, setRateLimited, clearRateLimit } = categorySlice.actions;\nexport default categorySlice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}