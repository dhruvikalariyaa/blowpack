{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useState, useCallback } from 'react';\nimport { handleApiError, retryRequest } from '../utils/errorHandler';\nexport const useApi = () => {\n  _s();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const makeRequest = useCallback(async (requestFn, options = {}) => {\n    const {\n      showLoading = true,\n      retry = true,\n      maxRetries = 3,\n      onError = null\n    } = options;\n    try {\n      if (showLoading) setLoading(true);\n      setError(null);\n      const response = await (retry ? retryRequest(requestFn, maxRetries) : requestFn());\n      return response;\n    } catch (err) {\n      const errorInfo = handleApiError(err, err.response);\n      setError(errorInfo);\n      if (onError) {\n        onError(errorInfo);\n      }\n      throw errorInfo;\n    } finally {\n      if (showLoading) setLoading(false);\n    }\n  }, []);\n  const clearError = useCallback(() => {\n    setError(null);\n  }, []);\n  return {\n    loading,\n    error,\n    makeRequest,\n    clearError\n  };\n};\n\n// Hook for handling 429 errors specifically\n_s(useApi, \"iJ3PdDr3kYgqiSBFvrzakIcQ/Wc=\");\nexport const useRateLimitHandler = () => {\n  _s2();\n  const [isRateLimited, setIsRateLimited] = useState(false);\n  const [retryAfter, setRetryAfter] = useState(null);\n  const handleRateLimit = useCallback(error => {\n    if (error.status === 429) {\n      setIsRateLimited(true);\n      setRetryAfter(error.retryAfter);\n\n      // Auto-clear rate limit after retry time\n      if (error.retryAfter) {\n        setTimeout(() => {\n          setIsRateLimited(false);\n          setRetryAfter(null);\n        }, error.retryAfter * 1000);\n      }\n    }\n  }, []);\n  const clearRateLimit = useCallback(() => {\n    setIsRateLimited(false);\n    setRetryAfter(null);\n  }, []);\n  return {\n    isRateLimited,\n    retryAfter,\n    handleRateLimit,\n    clearRateLimit\n  };\n};\n_s2(useRateLimitHandler, \"wkVh44ZHJdXoS8FguiCicTEe2zA=\");","map":{"version":3,"names":["useState","useCallback","handleApiError","retryRequest","useApi","_s","loading","setLoading","error","setError","makeRequest","requestFn","options","showLoading","retry","maxRetries","onError","response","err","errorInfo","clearError","useRateLimitHandler","_s2","isRateLimited","setIsRateLimited","retryAfter","setRetryAfter","handleRateLimit","status","setTimeout","clearRateLimit"],"sources":["E:/blowpack/frountend/src/hooks/useApi.js"],"sourcesContent":["import { useState, useCallback } from 'react';\r\nimport { handleApiError, retryRequest } from '../utils/errorHandler';\r\n\r\nexport const useApi = () => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const makeRequest = useCallback(async (requestFn, options = {}) => {\r\n    const { \r\n      showLoading = true, \r\n      retry = true, \r\n      maxRetries = 3,\r\n      onError = null \r\n    } = options;\r\n\r\n    try {\r\n      if (showLoading) setLoading(true);\r\n      setError(null);\r\n\r\n      const response = await (retry ? retryRequest(requestFn, maxRetries) : requestFn());\r\n      \r\n      return response;\r\n    } catch (err) {\r\n      const errorInfo = handleApiError(err, err.response);\r\n      setError(errorInfo);\r\n      \r\n      if (onError) {\r\n        onError(errorInfo);\r\n      }\r\n      \r\n      throw errorInfo;\r\n    } finally {\r\n      if (showLoading) setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const clearError = useCallback(() => {\r\n    setError(null);\r\n  }, []);\r\n\r\n  return {\r\n    loading,\r\n    error,\r\n    makeRequest,\r\n    clearError\r\n  };\r\n};\r\n\r\n// Hook for handling 429 errors specifically\r\nexport const useRateLimitHandler = () => {\r\n  const [isRateLimited, setIsRateLimited] = useState(false);\r\n  const [retryAfter, setRetryAfter] = useState(null);\r\n\r\n  const handleRateLimit = useCallback((error) => {\r\n    if (error.status === 429) {\r\n      setIsRateLimited(true);\r\n      setRetryAfter(error.retryAfter);\r\n      \r\n      // Auto-clear rate limit after retry time\r\n      if (error.retryAfter) {\r\n        setTimeout(() => {\r\n          setIsRateLimited(false);\r\n          setRetryAfter(null);\r\n        }, error.retryAfter * 1000);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  const clearRateLimit = useCallback(() => {\r\n    setIsRateLimited(false);\r\n    setRetryAfter(null);\r\n  }, []);\r\n\r\n  return {\r\n    isRateLimited,\r\n    retryAfter,\r\n    handleRateLimit,\r\n    clearRateLimit\r\n  };\r\n};\r\n"],"mappings":";;AAAA,SAASA,QAAQ,EAAEC,WAAW,QAAQ,OAAO;AAC7C,SAASC,cAAc,EAAEC,YAAY,QAAQ,uBAAuB;AAEpE,OAAO,MAAMC,MAAM,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC1B,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGP,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACQ,KAAK,EAAEC,QAAQ,CAAC,GAAGT,QAAQ,CAAC,IAAI,CAAC;EAExC,MAAMU,WAAW,GAAGT,WAAW,CAAC,OAAOU,SAAS,EAAEC,OAAO,GAAG,CAAC,CAAC,KAAK;IACjE,MAAM;MACJC,WAAW,GAAG,IAAI;MAClBC,KAAK,GAAG,IAAI;MACZC,UAAU,GAAG,CAAC;MACdC,OAAO,GAAG;IACZ,CAAC,GAAGJ,OAAO;IAEX,IAAI;MACF,IAAIC,WAAW,EAAEN,UAAU,CAAC,IAAI,CAAC;MACjCE,QAAQ,CAAC,IAAI,CAAC;MAEd,MAAMQ,QAAQ,GAAG,OAAOH,KAAK,GAAGX,YAAY,CAACQ,SAAS,EAAEI,UAAU,CAAC,GAAGJ,SAAS,CAAC,CAAC,CAAC;MAElF,OAAOM,QAAQ;IACjB,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZ,MAAMC,SAAS,GAAGjB,cAAc,CAACgB,GAAG,EAAEA,GAAG,CAACD,QAAQ,CAAC;MACnDR,QAAQ,CAACU,SAAS,CAAC;MAEnB,IAAIH,OAAO,EAAE;QACXA,OAAO,CAACG,SAAS,CAAC;MACpB;MAEA,MAAMA,SAAS;IACjB,CAAC,SAAS;MACR,IAAIN,WAAW,EAAEN,UAAU,CAAC,KAAK,CAAC;IACpC;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMa,UAAU,GAAGnB,WAAW,CAAC,MAAM;IACnCQ,QAAQ,CAAC,IAAI,CAAC;EAChB,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;IACLH,OAAO;IACPE,KAAK;IACLE,WAAW;IACXU;EACF,CAAC;AACH,CAAC;;AAED;AAAAf,EAAA,CA7CaD,MAAM;AA8CnB,OAAO,MAAMiB,mBAAmB,GAAGA,CAAA,KAAM;EAAAC,GAAA;EACvC,MAAM,CAACC,aAAa,EAAEC,gBAAgB,CAAC,GAAGxB,QAAQ,CAAC,KAAK,CAAC;EACzD,MAAM,CAACyB,UAAU,EAAEC,aAAa,CAAC,GAAG1B,QAAQ,CAAC,IAAI,CAAC;EAElD,MAAM2B,eAAe,GAAG1B,WAAW,CAAEO,KAAK,IAAK;IAC7C,IAAIA,KAAK,CAACoB,MAAM,KAAK,GAAG,EAAE;MACxBJ,gBAAgB,CAAC,IAAI,CAAC;MACtBE,aAAa,CAAClB,KAAK,CAACiB,UAAU,CAAC;;MAE/B;MACA,IAAIjB,KAAK,CAACiB,UAAU,EAAE;QACpBI,UAAU,CAAC,MAAM;UACfL,gBAAgB,CAAC,KAAK,CAAC;UACvBE,aAAa,CAAC,IAAI,CAAC;QACrB,CAAC,EAAElB,KAAK,CAACiB,UAAU,GAAG,IAAI,CAAC;MAC7B;IACF;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMK,cAAc,GAAG7B,WAAW,CAAC,MAAM;IACvCuB,gBAAgB,CAAC,KAAK,CAAC;IACvBE,aAAa,CAAC,IAAI,CAAC;EACrB,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;IACLH,aAAa;IACbE,UAAU;IACVE,eAAe;IACfG;EACF,CAAC;AACH,CAAC;AAACR,GAAA,CA9BWD,mBAAmB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}