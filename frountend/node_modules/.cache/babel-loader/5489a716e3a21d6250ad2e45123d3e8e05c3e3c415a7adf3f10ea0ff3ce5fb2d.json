{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { handleApiError, retryRequest } from '../utils/errorHandler';\n\n// Async thunks\nexport const fetchCategories = createAsyncThunk('categories/fetchCategories', async (params = {}, {\n  rejectWithValue,\n  getState\n}) => {\n  try {\n    // Check if we already have categories and this is not a forced refresh\n    const state = getState();\n    if (state.categories.categories.length > 0 && !params.forceRefresh) {\n      return state.categories;\n    }\n    const requestFn = async () => {\n      const response = await axios.get('/api/categories', {\n        params\n      });\n      return response.data.data;\n    };\n\n    // Use retry logic for rate limiting\n    const data = await retryRequest(requestFn, 3, 1000);\n    return data;\n  } catch (error) {\n    const errorInfo = handleApiError(error, error.response);\n    return rejectWithValue(errorInfo.message || 'Failed to fetch categories');\n  }\n});\nexport const fetchCategory = createAsyncThunk('categories/fetchCategory', async (categoryId, {\n  rejectWithValue\n}) => {\n  try {\n    const requestFn = async () => {\n      const response = await axios.get(`/api/categories/${categoryId}`);\n      return response.data.data;\n    };\n\n    // Use retry logic for rate limiting\n    const data = await retryRequest(requestFn, 3, 1000);\n    return data;\n  } catch (error) {\n    const errorInfo = handleApiError(error, error.response);\n    return rejectWithValue(errorInfo.message || 'Failed to fetch category');\n  }\n});\nconst initialState = {\n  categories: [],\n  currentCategory: null,\n  pagination: {\n    currentPage: 1,\n    totalPages: 1,\n    totalItems: 0,\n    itemsPerPage: 20,\n    hasNextPage: false,\n    hasPrevPage: false\n  },\n  loading: false,\n  error: null,\n  isRateLimited: false,\n  retryAfter: null,\n  lastFetched: null\n};\nconst categorySlice = createSlice({\n  name: 'categories',\n  initialState,\n  reducers: {\n    clearError: state => {\n      state.error = null;\n    },\n    clearCurrentCategory: state => {\n      state.currentCategory = null;\n    }\n  },\n  extraReducers: builder => {\n    builder\n    // Fetch categories\n    .addCase(fetchCategories.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(fetchCategories.fulfilled, (state, action) => {\n      state.loading = false;\n      state.categories = action.payload.categories;\n      state.pagination = action.payload.pagination;\n      state.error = null;\n    }).addCase(fetchCategories.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload;\n    })\n    // Fetch single category\n    .addCase(fetchCategory.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(fetchCategory.fulfilled, (state, action) => {\n      state.loading = false;\n      state.currentCategory = action.payload.category;\n      state.error = null;\n    }).addCase(fetchCategory.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload;\n    });\n  }\n});\nexport const {\n  clearError,\n  clearCurrentCategory\n} = categorySlice.actions;\nexport default categorySlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","handleApiError","retryRequest","fetchCategories","params","rejectWithValue","getState","state","categories","length","forceRefresh","requestFn","response","get","data","error","errorInfo","message","fetchCategory","categoryId","initialState","currentCategory","pagination","currentPage","totalPages","totalItems","itemsPerPage","hasNextPage","hasPrevPage","loading","isRateLimited","retryAfter","lastFetched","categorySlice","name","reducers","clearError","clearCurrentCategory","extraReducers","builder","addCase","pending","fulfilled","action","payload","rejected","category","actions","reducer"],"sources":["E:/blowpack/frountend/src/store/slices/categorySlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { handleApiError, retryRequest } from '../utils/errorHandler';\n\n// Async thunks\nexport const fetchCategories = createAsyncThunk(\n  'categories/fetchCategories',\n  async (params = {}, { rejectWithValue, getState }) => {\n    try {\n      // Check if we already have categories and this is not a forced refresh\n      const state = getState();\n      if (state.categories.categories.length > 0 && !params.forceRefresh) {\n        return state.categories;\n      }\n\n      const requestFn = async () => {\n        const response = await axios.get('/api/categories', { params });\n        return response.data.data;\n      };\n\n      // Use retry logic for rate limiting\n      const data = await retryRequest(requestFn, 3, 1000);\n      return data;\n    } catch (error) {\n      const errorInfo = handleApiError(error, error.response);\n      return rejectWithValue(errorInfo.message || 'Failed to fetch categories');\n    }\n  }\n);\n\nexport const fetchCategory = createAsyncThunk(\n  'categories/fetchCategory',\n  async (categoryId, { rejectWithValue }) => {\n    try {\n      const requestFn = async () => {\n        const response = await axios.get(`/api/categories/${categoryId}`);\n        return response.data.data;\n      };\n\n      // Use retry logic for rate limiting\n      const data = await retryRequest(requestFn, 3, 1000);\n      return data;\n    } catch (error) {\n      const errorInfo = handleApiError(error, error.response);\n      return rejectWithValue(errorInfo.message || 'Failed to fetch category');\n    }\n  }\n);\n\nconst initialState = {\n  categories: [],\n  currentCategory: null,\n  pagination: {\n    currentPage: 1,\n    totalPages: 1,\n    totalItems: 0,\n    itemsPerPage: 20,\n    hasNextPage: false,\n    hasPrevPage: false,\n  },\n  loading: false,\n  error: null,\n  isRateLimited: false,\n  retryAfter: null,\n  lastFetched: null,\n};\n\nconst categorySlice = createSlice({\n  name: 'categories',\n  initialState,\n  reducers: {\n    clearError: (state) => {\n      state.error = null;\n    },\n    clearCurrentCategory: (state) => {\n      state.currentCategory = null;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      // Fetch categories\n      .addCase(fetchCategories.pending, (state) => {\n        state.loading = true;\n        state.error = null;\n      })\n      .addCase(fetchCategories.fulfilled, (state, action) => {\n        state.loading = false;\n        state.categories = action.payload.categories;\n        state.pagination = action.payload.pagination;\n        state.error = null;\n      })\n      .addCase(fetchCategories.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload;\n      })\n      // Fetch single category\n      .addCase(fetchCategory.pending, (state) => {\n        state.loading = true;\n        state.error = null;\n      })\n      .addCase(fetchCategory.fulfilled, (state, action) => {\n        state.loading = false;\n        state.currentCategory = action.payload.category;\n        state.error = null;\n      })\n      .addCase(fetchCategory.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload;\n      });\n  },\n});\n\nexport const { clearError, clearCurrentCategory } = categorySlice.actions;\nexport default categorySlice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}