{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{PhotoIcon,XMarkIcon}from'@heroicons/react/24/outline';import{API_ENDPOINTS}from'../../config/api';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const ImageUpload=_ref=>{let{images=[],onImagesChange,maxImages=5,multiple=true,className=''}=_ref;const[uploading,setUploading]=useState(false);const[error,setError]=useState(null);const fileInputRef=useRef(null);const handleFileSelect=async event=>{const files=Array.from(event.target.files);if(files.length===0)return;// Validate file count\nif(images.length+files.length>maxImages){setError(\"Maximum \".concat(maxImages,\" images allowed\"));return;}// Validate file types and sizes\nconst validFiles=files.filter(file=>{if(!file.type.startsWith('image/')){setError('Only image files are allowed');return false;}if(file.size>5*1024*1024){// 5MB\nsetError('File size must be less than 5MB');return false;}return true;});if(validFiles.length===0)return;setError(null);// For product creation/editing, we'll store the files directly\n// and upload them when the form is submitted\nconst newImages=validFiles.map(file=>({file:file,url:URL.createObjectURL(file),// Create preview URL\nalt:\"Product image\",isNew:true// Flag to identify new files\n}));onImagesChange([...images,...newImages]);// Reset file input\nif(fileInputRef.current){fileInputRef.current.value='';}};const removeImage=index=>{const imageToRemove=images[index];// Clean up object URL if it's a new file\nif(imageToRemove&&imageToRemove.isNew&&imageToRemove.url){URL.revokeObjectURL(imageToRemove.url);}const newImages=images.filter((_,i)=>i!==index);onImagesChange(newImages);};const openFileDialog=()=>{var _fileInputRef$current;(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();};// Cleanup object URLs on unmount\nuseEffect(()=>{return()=>{images.forEach(image=>{if(image.isNew&&image.url){URL.revokeObjectURL(image.url);}});};},[images]);return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4 \".concat(className),children:[/*#__PURE__*/_jsxs(\"div\",{onClick:openFileDialog,className:\"relative border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors \".concat(uploading?'border-blue-400 bg-blue-50':'border-gray-300 hover:border-gray-400'),children:[/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"image/*\",multiple:multiple,onChange:handleFileSelect,className:\"hidden\",disabled:uploading}),/*#__PURE__*/_jsx(PhotoIcon,{className:\"mx-auto h-12 w-12 text-gray-400\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:uploading?/*#__PURE__*/_jsx(\"span\",{className:\"text-blue-600\",children:\"Uploading...\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-blue-600 hover:text-blue-500\",children:\"Click to upload\"}),' ',\"or drag and drop\"]})}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:[\"PNG, JPG, GIF up to 5MB each\",multiple&&\" (max \".concat(maxImages,\" images)\")]})]})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-red-600 bg-red-50 border border-red-200 rounded-md p-2\",children:error}),images.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4\",children:images.map((image,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"img\",{src:image.url,alt:image.alt,className:\"w-full h-24 object-cover rounded-lg border border-gray-200\"}),image.isNew&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-1 left-1 bg-blue-500 text-white text-xs px-1 py-0.5 rounded\",children:\"New\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>removeImage(index),className:\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity\",children:/*#__PURE__*/_jsx(XMarkIcon,{className:\"h-4 w-4\"})})]},index))}),uploading&&/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-600 h-2 rounded-full animate-pulse\"})})]});};export default ImageUpload;","map":{"version":3,"names":["React","useState","useRef","useEffect","PhotoIcon","XMarkIcon","API_ENDPOINTS","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ImageUpload","_ref","images","onImagesChange","maxImages","multiple","className","uploading","setUploading","error","setError","fileInputRef","handleFileSelect","event","files","Array","from","target","length","concat","validFiles","filter","file","type","startsWith","size","newImages","map","url","URL","createObjectURL","alt","isNew","current","value","removeImage","index","imageToRemove","revokeObjectURL","_","i","openFileDialog","_fileInputRef$current","click","forEach","image","children","onClick","ref","accept","onChange","disabled","src"],"sources":["E:/blowpack/frountend/src/components/common/ImageUpload.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { PhotoIcon, XMarkIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api';\n\nconst ImageUpload = ({ \n  images = [], \n  onImagesChange, \n  maxImages = 5, \n  multiple = true,\n  className = '' \n}) => {\n  const [uploading, setUploading] = useState(false);\n  const [error, setError] = useState(null);\n  const fileInputRef = useRef(null);\n\n  const handleFileSelect = async (event) => {\n    const files = Array.from(event.target.files);\n    \n    if (files.length === 0) return;\n\n    // Validate file count\n    if (images.length + files.length > maxImages) {\n      setError(`Maximum ${maxImages} images allowed`);\n      return;\n    }\n\n    // Validate file types and sizes\n    const validFiles = files.filter(file => {\n      if (!file.type.startsWith('image/')) {\n        setError('Only image files are allowed');\n        return false;\n      }\n      if (file.size > 5 * 1024 * 1024) { // 5MB\n        setError('File size must be less than 5MB');\n        return false;\n      }\n      return true;\n    });\n\n    if (validFiles.length === 0) return;\n\n    setError(null);\n\n    // For product creation/editing, we'll store the files directly\n    // and upload them when the form is submitted\n    const newImages = validFiles.map(file => ({\n      file: file,\n      url: URL.createObjectURL(file), // Create preview URL\n      alt: `Product image`,\n      isNew: true // Flag to identify new files\n    }));\n\n    onImagesChange([...images, ...newImages]);\n\n    // Reset file input\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const removeImage = (index) => {\n    const imageToRemove = images[index];\n    \n    // Clean up object URL if it's a new file\n    if (imageToRemove && imageToRemove.isNew && imageToRemove.url) {\n      URL.revokeObjectURL(imageToRemove.url);\n    }\n    \n    const newImages = images.filter((_, i) => i !== index);\n    onImagesChange(newImages);\n  };\n\n  const openFileDialog = () => {\n    fileInputRef.current?.click();\n  };\n\n  // Cleanup object URLs on unmount\n  useEffect(() => {\n    return () => {\n      images.forEach(image => {\n        if (image.isNew && image.url) {\n          URL.revokeObjectURL(image.url);\n        }\n      });\n    };\n  }, [images]);\n\n  return (\n    <div className={`space-y-4 ${className}`}>\n      {/* Upload Area */}\n      <div\n        onClick={openFileDialog}\n        className={`relative border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors ${\n          uploading \n            ? 'border-blue-400 bg-blue-50' \n            : 'border-gray-300 hover:border-gray-400'\n        }`}\n      >\n        <input\n          ref={fileInputRef}\n          type=\"file\"\n          accept=\"image/*\"\n          multiple={multiple}\n          onChange={handleFileSelect}\n          className=\"hidden\"\n          disabled={uploading}\n        />\n        \n        <PhotoIcon className=\"mx-auto h-12 w-12 text-gray-400\" />\n        \n        <div className=\"mt-2\">\n          <p className=\"text-sm text-gray-600\">\n            {uploading ? (\n              <span className=\"text-blue-600\">Uploading...</span>\n            ) : (\n              <>\n                <span className=\"font-medium text-blue-600 hover:text-blue-500\">\n                  Click to upload\n                </span>\n                {' '}or drag and drop\n              </>\n            )}\n          </p>\n          <p className=\"text-xs text-gray-500 mt-1\">\n            PNG, JPG, GIF up to 5MB each\n            {multiple && ` (max ${maxImages} images)`}\n          </p>\n        </div>\n      </div>\n\n      {/* Error Message */}\n      {error && (\n        <div className=\"text-sm text-red-600 bg-red-50 border border-red-200 rounded-md p-2\">\n          {error}\n        </div>\n      )}\n\n      {/* Image Preview */}\n      {images.length > 0 && (\n        <div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4\">\n          {images.map((image, index) => (\n            <div key={index} className=\"relative group\">\n              <img\n                src={image.url}\n                alt={image.alt}\n                className=\"w-full h-24 object-cover rounded-lg border border-gray-200\"\n              />\n              {image.isNew && (\n                <div className=\"absolute top-1 left-1 bg-blue-500 text-white text-xs px-1 py-0.5 rounded\">\n                  New\n                </div>\n              )}\n              <button\n                type=\"button\"\n                onClick={() => removeImage(index)}\n                className=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity\"\n              >\n                <XMarkIcon className=\"h-4 w-4\" />\n              </button>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Upload Progress */}\n      {uploading && (\n        <div className=\"w-full bg-gray-200 rounded-full h-2\">\n          <div className=\"bg-blue-600 h-2 rounded-full animate-pulse\"></div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ImageUpload;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}